<script>
alert("JS真的有執行，請略過此訊息");

let currentUser=null;

function init(){
  if(!localStorage.getItem("users")){
    localStorage.setItem("users",JSON.stringify({}));
  }
  if(!localStorage.getItem("boards")){
    localStorage.setItem("boards",JSON.stringify({
      "Minecraft":[],
      "聊天":[],
      "公告":[],
      "魚板":[]
    }));
  }
}

function login(){
  let u=document.getElementById("username").value;
  let p=document.getElementById("password").value;

  let users=JSON.parse(localStorage.getItem("users")||"{}");

  if(users[u]){
    if(users[u].password!==p){
      alert("密碼錯誤");
      return;
    }
  }else{
    users[u]={password:p};
    localStorage.setItem("users",JSON.stringify(users));
  }

  currentUser=u;
  document.getElementById("auth").style.display="none";
  document.getElementById("bbs").style.display="block";
  document.getElementById("currentUser").innerText=u;
  loadPosts();
}

function logout(){
  currentUser=null;
  document.getElementById("auth").style.display="block";
  document.getElementById("bbs").style.display="none";
}

function loadPosts(){
  let board=document.getElementById("boardSelect").value;
  let boards=JSON.parse(localStorage.getItem("boards"));
  let postsDiv=document.getElementById("posts");
  postsDiv.innerHTML="";
  boards[board].forEach(p=>{
    postsDiv.innerHTML+=`<p>[${p.time}] ${p.user} > ${p.text}</p>`;
  });
}

function post(){
  let board=document.getElementById("boardSelect").value;
  let text=document.getElementById("msg").value;
  let boards=JSON.parse(localStorage.getItem("boards"));

  boards[board].push({
    user:currentUser,
    text:text,
    time:new Date().toLocaleString()
  });

  localStorage.setItem("boards",JSON.stringify(boards));
  document.getElementById("msg").value="";
  loadPosts();
}

init();
                       </script>
version 1.0.0 bugfix
