<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>å°é­šBBSç³»çµ± V1.0.0</title>
<style>
body{
  background:black;
  color:#00ff00;
  font-family:noto-sans;
}
input,button,select{
  background:black;
  color:#00ff00;
  border:1px solid #00ff00;
}
.panel{
  border:1px solid #00ff00;
  padding:10px;
  margin:10px 0;
}
</style>
</head>
<body>
  <script src="storage.js"></script>

<h2>=== å°é­š BBS ç³»çµ± V1.0.0 ===</h2>

<div id="auth" class="panel">
  <input id="username" placeholder="å¸³è™Ÿ">
  <input id="password" type="password" placeholder="å¯†ç¢¼">
  <button onclick="login()">ç™»å…¥ / è¨»å†Š</button>
</div>

<div id="bbs" style="display:none">
  ğŸ‘¤ ç›®å‰ä½¿ç”¨è€…ï¼š<span id="currentUser"></span>
  <button onclick="logout()">ç™»å‡º</button>

  <div class="panel">
    çœ‹æ¿ï¼š
    <select id="boardSelect" onchange="loadPosts()">
      <option>Minecraft</option>
      <option>èŠå¤©</option>
      <option>å…¬å‘Š</option>
      <option>é­šæ¿</option>
    </select>
  </div>

  <div class="panel">
    <input id="msg" placeholder="è¼¸å…¥è¨Šæ¯">
    <button onclick="post()">ç™¼æ–‡</button>
  </div>

  <div class="panel" id="posts"></div>
</div>

<script>
alert("JSçœŸçš„æœ‰åŸ·è¡Œ V1.0.0");

// ----------------------------
// å…¨åŸŸè®Šæ•¸
// ----------------------------
let currentUser = null;

// ----------------------------
// åˆå§‹åŒ–
// ----------------------------
function init(){
  if(!localStorage.getItem("users")){
    localStorage.setItem("users", JSON.stringify({}));
  }
  if(!localStorage.getItem("boards")){
    localStorage.setItem("boards", JSON.stringify({
      "Minecraft": [],
      "èŠå¤©": [],
      "å…¬å‘Š": [],
      "é­šæ¿": []
    }));
  }
}

// ----------------------------
// ç™»å…¥ / è¨»å†Š
// ----------------------------
function login(){
  let u = document.getElementById("username").value.trim();
  let p = document.getElementById("password").value.trim();

  if(!u || !p){
    alert("è«‹è¼¸å…¥å¸³è™Ÿèˆ‡å¯†ç¢¼");
    return;
  }

  let users = JSON.parse(localStorage.getItem("users") || "{}");

  if(users[u]){
    if(users[u].password !== p){
      alert("å¯†ç¢¼éŒ¯èª¤");
      return;
    }
  } else {
    users[u] = { password: p };
    localStorage.setItem("users", JSON.stringify(users));
  }

  currentUser = u;
  document.getElementById("auth").style.display = "none";
  document.getElementById("bbs").style.display = "block";
  document.getElementById("currentUser").innerText = u;
  loadPosts();
}

// ----------------------------
// ç™»å‡º
// ----------------------------
function logout(){
  currentUser = null;
  document.getElementById("auth").style.display = "block";
  document.getElementById("bbs").style.display = "none";
}

// ----------------------------
// è®€å–æ–‡ç« 
// ----------------------------
function loadPosts(){
  let board = document.getElementById("boardSelect").value;
  let boards = JSON.parse(localStorage.getItem("boards") || "{}");
  let postsDiv = document.getElementById("posts");
  postsDiv.innerHTML = "";

  if(!boards[board]) boards[board] = [];

  boards[board].forEach(p=>{
    postsDiv.innerHTML += `<p>[${p.time}] ${p.user} > ${p.text}</p>`;
  });
}

// ----------------------------
// ç™¼æ–‡
// ----------------------------
function post(){
  let board = document.getElementById("boardSelect").value;
  let text = document.getElementById("msg").value.trim();

  if(!text){
    alert("è«‹è¼¸å…¥è¨Šæ¯");
    return;
  }

  let boards = JSON.parse(localStorage.getItem("boards") || "{}");
  if(!boards[board]) boards[board] = [];

  boards[board].push({
    user: currentUser,
    text: text,
    time: new Date().toLocaleString()
  });

  localStorage.setItem("boards", JSON.stringify(boards));
  document.getElementById("msg").value = "";
  loadPosts();
}

// ----------------------------
// å•Ÿå‹•
// ----------------------------
init();
</script>

</body>
</html>
